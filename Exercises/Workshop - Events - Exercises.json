{"version":"5","defaultTimeframe":{"from":"now-60d","to":"now","details":{"from":{"type":"expression","normalized":"now-60d","date":"2023-11-24T16:59:27.275Z"},"to":{"type":"expression","normalized":"now","date":"2024-01-23T16:59:27.275Z"}}},"sections":[{"id":"23556987-d686-4f35-82f5-938f1b06a230","type":"markdown","markdown":"# Events\n##  Davis Problem Events \n* Problem Cards: Monitoring Unavailable, Availablity, Error, Slowdown, Resource, or Custom Events\n* Problems Opened, Updated, or Closed\n* [Categories of Events](https://docs.dynatrace.com/docs/shortlink/event-types)\n\n![](https://mkt-cdn.dynatrace.com/assets/Marketing/illustrations/davis-explained.svg)\n## Davis Events\n * Informational events that maybe relevant for root cause analysis or identifying environment changes\n * Framework Changes, Process Crashes, K8s Events, Deployment Events, Annotations\n * [Info Events](https://docs.dynatrace.com/docs/shortlink/event-types-info)\n ![](https://github.com/JasonOstroski/perform-hot24-intro-to-dql/blob/main/images/events.jpg?raw=true)\n\n## Security Events\n * Third party vulnerability or code level vulnerability events\n * [Security Event Data Structure](https://docs.dynatrace.com/docs/shortlink/security-events-data-structure)\n![](https://github.com/JasonOstroski/perform-hot24-intro-to-dql/blob/main/images/vuln.jpg?raw=true)\n\n##  We can also query the SmartScape topology model with DQL!\n\n ![](https://mkt-cdn.dynatrace.com/assets/Marketing/screenshots/smartscape-service-web-request.png?_ga=2.39254048.2092106028.1702994875-263697944.1702056672&_gac=1.121478266.1702998561.Cj0KCQiAm4WsBhCiARIsAEJIEzX2Jl04XSrkrmt9bcO4tCFI0BRMNM4W2N2LvYiy7L0DBLC-os4jQFoaAmycEALw_wcB&_gl=1*mtlpmg*_ga*MjYzNjk3OTQ0LjE3MDIwNTY2NzI.*_ga_1MEMV02JXV*MTcwMzAxMjE2Ny4yMDkuMS4xNzAzMDEzNjE3LjAuMC4w)"},{"id":"7d145309-4b60-4ff7-9256-cdca41ec852b","type":"markdown","markdown":"# Exercise 1 - Get familiar with Events\n1. Use the FETCH command to query, sort, and limit events\n2. Summarize all events by event kind and visualize in a pie chart\n3. Summarize Davis Problems by event category"},{"id":"02877cc5-8a78-462d-a08d-e552b05f3a40","type":"dql","title":"Exercise 1.1 - Fetch events, sort, and limit the results","showTitle":true,"drilldownPath":[],"state":{"input":{"value":"","timeframe":{"from":"now-2h","to":"now"}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"63e83bda-81e1-4ef2-b014-b19988ec2d91","type":"dql","showTitle":false,"title":"Exercise 1.2 - Summarize all events by event kind and visualize in a pie chart","state":{"input":{"value":"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-11-26T19:20:52.223Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:20:52.223Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"97ef0880-e334-41c1-934b-acefe8856d80","type":"dql","showTitle":false,"title":"Exercise 1.3 - Summarize Davis Problems by event category","state":{"input":{"value":"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-11-26T19:20:45.722Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:20:45.722Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"8264f3f1-200f-4a06-b862-c0a15907daa0","type":"markdown","markdown":"# Exercise 2 - DQL for Topology\n1. Get familiar with the service entity table\n2. Get familiar with the host entity table and runs command\n3. Expand on runs\n4. Show and expand tags on a host"},{"id":"3ce79118-58c2-4ddf-b9f0-e1d20948d92b","type":"dql","title":"Exercise 2.1 - Fetch the service entity table","showTitle":false,"state":{"input":{"value":"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-11-26T19:20:52.223Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:20:52.223Z"}}}},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"4ccd2bcc-6fa4-46c6-ac34-3f2de8ce9a72","type":"dql","title":"Exercise 2.2 - Fetch the host entity table, and add \"runs\"","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-11-26T19:20:52.223Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:20:52.223Z"}}}},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"963c1379-be58-4fc2-b05c-608d89b3a2e4","type":"dql","title":"Exercise 2.3 - Same as 2.2, but now expand runs to show the service entities","showTitle":false,"drilldownPath":[],"state":{"input":{"value":"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-11-26T19:20:52.223Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:20:52.223Z"}}}},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"2c9543ec-c71f-43d8-8ba2-87e95d7e0844","type":"dql","title":"Exercise 2.4 - Fetch the host entities, and expand the tags","showTitle":false,"state":{"input":{"value":"","timeframe":{"from":"now-24h","to":"now","details":{"from":{"type":"expression","normalized":"now-24h","date":"2023-11-26T19:20:52.223Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:20:52.223Z"}}}},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"3c89d839-fdcb-4881-9c29-c023c0fbf37b","type":"markdown","markdown":"# Exercise 3 - Find the most problematic services\n1. For the Davis Problems, expand the array of affected entity ids\n2. Filter only on problems have services in the affected entity ids\n3. Use the expanded affected entity ids to lookup the service name in the entity table (hint: look at the lookup function documentation) \n4. Display the top 10 \"most problematic\" services by name and count of distinct problem display id in a categorical chart. Sort count descending."},{"id":"6568f4c5-5177-4ea9-b491-6d3268385995","type":"dql","showTitle":false,"title":"Exercise 3.1 - Fetch events that are Davis Problems, expand the affected entity IDs field, and return only category, name, and affected entity IDs","state":{"input":{"value":"","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-10-10T16:15:23.931Z"},"to":{"type":"expression","normalized":"now","date":"2023-10-17T16:15:23.931Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"4b8471f1-1531-451a-86e4-4149db455762","type":"dql","showTitle":false,"title":"Exercise 3.2 - Filter only on problems have services in the affected entity ids","state":{"input":{"value":"","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-10-10T16:15:23.931Z"},"to":{"type":"expression","normalized":"now","date":"2023-10-17T16:15:23.931Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"bd86e53a-66cf-4c14-9ab4-6c4a0b384a90","type":"dql","showTitle":false,"title":"Exercise 3.3 - After expanding, use lookup to get the Service name that was affected by the event","state":{"input":{"value":"","timeframe":{"from":"now-60d","to":"now","details":{"from":{"type":"expression","normalized":"now-60d","date":"2023-11-24T16:58:53.182Z"},"to":{"type":"expression","normalized":"now","date":"2024-01-23T16:58:53.182Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"b0b43613-f3b4-4ec4-a692-9a36b0ddd0a4","type":"dql","showTitle":false,"title":"Exercise 3.4 - Display the top 10 \"most problematic\" services by name and count of distinct problem display id","state":{"input":{"value":"","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-10-10T16:15:23.931Z"},"to":{"type":"expression","normalized":"now","date":"2023-10-17T16:15:23.931Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"41c3bfbe-c24e-4780-b2fe-5b95a2c8e605","type":"markdown","markdown":"# Exercise 4 - Get familiar with Security Events\n1. Query for Vulnerabilities at an Entity level and see the fields it returns\n2. Use automated and pre-built DQL Notebook Template from Security page\n3. Use automated and pre-built DQL Notebook Dashboard from Security page"},{"id":"09af08c5-e3a5-44eb-86ad-4d8ea2633e20","type":"dql","showTitle":false,"title":"Exercise 4.1 - Fetch Events and filter for Vulnerability Events using event provider, event type, and event level","state":{"input":{"value":"","timeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2023-10-31T14:12:11.704Z"},"to":{"type":"expression","normalized":"now","date":"2023-10-31T15:12:11.704Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"c3cbf690-9707-4622-b0d5-86c675e426a7","type":"markdown","markdown":"## Exercise 4.2: Generate AppSec Notebook\n* Navigate to Security Overview \n* click on Third Party Vulnerabilities\n* click \"Open With...\"\n* click *Notebook* and choose Threat Exposure Template\n\n## Exercise 4.3: Generate AppSec Dashboard\n* Navigate to Security Overview \n* click on Third Party Vulnerabilities\n* click \"Open With...\"\n* click *Dashboard* and choose Threat Exposure Template\n![](https://github.com/JasonOstroski/perform-hot24-intro-to-dql/blob/main/images/appsecreport.jpg?raw=true)"},{"id":"882d139d-6804-4635-9445-0776dbe3a3ec","type":"markdown","markdown":"# Exercise 5 - Time to Restore Service (MTTR)\n1. Fetch Davis Problems that had a resolved problem duration (not null), were closed, and with severity of Error\n2. Summarize the average problem duration in milliseconds\n3. Create a new field for average problem duration in minutes\n"},{"id":"170ea2fb-6377-45d6-ba2a-5b404210dec2","type":"dql","showTitle":false,"title":"Exercise 5.1 - Fetch Events (Davis Problems), where the resolved_problem_duration is populated, the event status is closed, and a category of Error","state":{"input":{"value":"","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-10-24T18:22:55.345Z"},"to":{"type":"expression","normalized":"now","date":"2023-10-31T18:22:55.345Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"79b8781e-4efe-4d51-a34b-4b1820d86a40","type":"dql","showTitle":false,"title":"Exercise 5.2 - Summarize the records according to the average resolved problem duration. This needs to make use of a certain aggregation function, and ensure the average duration result is in milliseconds. ","state":{"input":{"value":"","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-11-20T19:02:14.610Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:02:14.610Z"}}}},"davis":{"includeLogs":true,"isDavisVisualizationAvailable":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}},{"id":"a3c4513b-ae6b-4aca-bd19-0d06b2c17b43","type":"dql","showTitle":false,"title":"Summarize 5.3 - Add a field to convert the field from the previous exercise from ms to minutes, and return only the final field.","state":{"input":{"value":"","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-11-20T19:02:14.610Z"},"to":{"type":"expression","normalized":"now","date":"2023-11-27T19:02:14.610Z"}}}},"davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}}}}]}